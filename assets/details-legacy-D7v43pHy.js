!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./chakra-legacy-DQqN9Dqk.js","./index-legacy-DJN3gwVR.js","./react-legacy-BuT440iH.js","./master-manager-legacy-D9dEF1LF.js","./change-type-modal-legacy-Ktj1ETuk.js","./tools-legacy-HTpdHrCY.js","./useEvent-legacy-cmpNx-2-.js","./misc-nodes-legacy-zdGIoDpi.js"],(function(e,n){"use strict";var r,i,s,a,l,o,c,u,d,p,h,g,m,x,f,b,j,y,w,v,S,A,E,N,O,C,k,z,W,P,I,R,D,T,L,F,M,U,V,_,B,J,q,G,H,Q,X,K,Y,Z,$,ee;return{setters:[e=>{r=e.j,i=e.B,s=e.aj,a=e.ak,l=e.av,o=e.t,c=e.aw,u=e.x,d=e.D,p=e.G,h=e.M,g=e.H,m=e.J,x=e.L,f=e.O,b=e.N},e=>{j=e.c,y=e.e,w=e.aP,v=e.X,S=e.aQ,A=e.aI,E=e.x,N=e.y,O=e.q,C=e.aF,k=e.L,z=e.p,W=e.V,P=e.aR,I=e.w,R=e.S,D=e.a3,T=e.a4,L=e.k,F=e.o,M=e.D,U=e.aJ,e.aM,V=e.aS,_=e.aT,B=e.aU},e=>{J=e.u,q=e.b},e=>{G=e.s},e=>{H=e.C,Q=e.c,X=e.a,K=e.b},e=>{Y=e.l,Z=e.L},e=>{$=e.u},e=>{ee=e.m}],execute:function(){function n(){const{t:e}=J(),t=j(),{selected:n}=y((e=>e.runtime)),p=q.useRef(window.graph),h=e=>{if(p.current.hasNode(e)){const t=p.current.getNodeAttributes(e),n=t.type;return e.startsWith("stn")?t[n].names.join("/"):n}if(p.current.hasEdge(e)){const[t,n]=p.current.extremities(e),r=p.current.getSourceAttributes(e),i=p.current.getTargetAttributes(e),s=r.type,a=i.type;return(t.startsWith("stn")?r[s].names[0]:s)+" - "+(n.startsWith("stn")?i[a].names[0]:a)}},[g,m]=q.useState([]);q.useEffect((()=>{m(["station","misc-node","line"])}),[n]);const[x,f]=q.useState(!1);return r.jsxs(i,{children:[r.jsxs(s,{as:"h5",size:"sm",children:[e("panel.details.multipleSelection.selected")," ",n.size]}),r.jsxs(a,{m:"var(--chakra-space-1)",children:[r.jsxs(l,{w:"100%",children:[r.jsx(s,{as:"h5",size:"xs",w:"100%",children:e("panel.details.multipleSelection.show")}),r.jsx(w,{selections:[{label:e("panel.details.multipleSelection.station"),value:"station"},{label:e("panel.details.multipleSelection.miscNode"),value:"misc-node"},{label:e("panel.details.multipleSelection.edge"),value:"line"}],defaultValue:g,multiSelect:!0,onChange:e=>m(e)})]}),0!==g.length&&r.jsxs(r.Fragment,{children:[r.jsxs(o,{width:"100%",size:"sm",onClick:()=>f(!0),children:[e("panel.details.multipleSelection.change"),r.jsx(c,{label:e("header.settings.pro"),children:r.jsx(u,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})})]}),r.jsx(d,{})]}),[...n].filter((e=>g.includes("station")||!e.startsWith("stn"))).filter((e=>g.includes("misc-node")||!e.startsWith("misc"))).filter((e=>g.includes("line")||!e.startsWith("line"))).map((e=>{var n;return r.jsxs(l,{width:"100%",children:[r.jsx(o,{width:"100%",size:"sm",variant:"solid",onClick:()=>t(v(new Set([e]))),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:null===(n=h(e))||void 0===n?void 0:n.replaceAll("\n","⏎")}),r.jsx(o,{size:"sm",onClick:()=>t(A(e)),children:r.jsx(S,{})})]},e)}))]}),r.jsx(H,{isOpen:x,onClose:()=>f(!1),isSelect:!0,filter:g})]})}function te(){var e,t;const{i18n:n,t:i}=J(),s=j(),a=q.useCallback((()=>{s(E()),s(N(b.current.export()))}),[s,E,N]),{preference:{autoParallel:l}}=y((e=>e.app)),{selected:c,theme:u}=y((e=>e.runtime)),[d]=c,b=q.useRef(window.graph),[w,v]=q.useState(!1),S=q.useRef(null),A=Object.fromEntries(Object.entries(O).map((([e,t])=>[e,i(t.metadata.displayName).toString()]))),[I,R]=q.useState(b.current.getEdgeAttribute(d,"type")),[D,T]=q.useState(void 0),L=Object.fromEntries(null!==(e=null===(t=Y[n.language])||void 0===t?void 0:t.map((e=>[e,i(C[e].metadata.displayName).toString()])))&&void 0!==e?e:[]),[F,M]=q.useState(b.current.getEdgeAttribute(d,"style")),[U,V]=q.useState(void 0);q.useEffect((()=>{R(b.current.getEdgeAttribute(d,"type")),M(b.current.getEdgeAttribute(d,"style"))}),[d]);const _=Object.values(k).filter((e=>!C[F].metadata.supportLinePathType.includes(e))),B=Object.values(z).filter((e=>!C[e].metadata.supportLinePathType.includes(I))),G=e=>{e&&(D?(D&&(Q(b.current,d,D,l),R(b.current.getEdgeAttribute(d,"type")),a()),T(void 0)):U&&(U&&(X(b.current,d,U,u),M(b.current.getEdgeAttribute(d,"style")),a()),V(void 0))),v(!1)};return r.jsxs(r.Fragment,{children:[r.jsx(W,{label:i("panel.details.info.linePathType"),minW:"276",children:r.jsx(P,{options:A,disabledOptions:_,defaultValue:I,value:I,onChange:({target:{value:e}})=>{T(e),v(!0)}})}),r.jsx(W,{label:i("panel.details.info.lineStyleType"),minW:"276",children:r.jsx(P,{options:L,disabledOptions:B,defaultValue:F,value:F,onChange:({target:{value:e}})=>{V(e),v(!0)}})}),r.jsx(Z,{type:"line",expand:!0}),r.jsx(p,{isOpen:w,leastDestructiveRef:S,onClose:()=>G(!1),children:r.jsx(h,{children:r.jsxs(g,{children:[r.jsx(m,{children:i("warning")}),r.jsx(x,{children:i("panel.details.changeLineTypeContent")}),r.jsxs(f,{children:[r.jsx(o,{ref:S,onClick:()=>G(!1),children:i("cancel")}),r.jsx(o,{ml:"2",colorScheme:"red",onClick:()=>G(!0),children:i("panel.details.changeType")})]})]})})})]})}function ne(){const{t:e}=J(),t=j(),n=q.useCallback((()=>{t(I()),t(N(l.current.export()))}),[t,I,N]),{selected:i,refresh:{nodes:s}}=y((e=>e.runtime)),[a]=i,l=q.useRef(window.graph),[c,u]=q.useState(!1),d=q.useRef(null),[b,w]=q.useState(void 0),[v,S]=q.useState(R.ShmetroBasic);q.useEffect((()=>{if(null!=a&&a.startsWith("stn")){const e=l.current.getNodeAttribute(a,"type");S(e)}}),[s,i]);const A=Object.fromEntries(Object.entries(G).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),E=e=>{e&&b&&(K(l.current,a,b),n()),w(void 0),u(!1)};return r.jsxs(r.Fragment,{children:[r.jsx(W,{label:e("panel.details.info.stationType"),minW:"276",children:r.jsx(P,{options:A,disabledOptions:[v],value:v,onChange:({target:{value:e}})=>{w(e),u(!0)}})}),r.jsx(p,{isOpen:c,leastDestructiveRef:d,onClose:()=>E(!1),children:r.jsx(h,{children:r.jsxs(g,{children:[r.jsx(m,{children:e("warning")}),r.jsx(x,{children:e("panel.details.changeStationTypeContent")}),r.jsxs(f,{children:[r.jsx(o,{ref:d,onClick:()=>E(!1),children:e("cancel")}),r.jsx(o,{ml:"2",colorScheme:"red",onClick:()=>E(!0),children:e("panel.details.changeType")})]})]})})})]})}function re(){const{t:e}=J(),t=j(),a=q.useCallback((()=>{t(I()),t(E()),t(N(d.current.export()))}),[t,I,E,N]),{activeSubscriptions:l}=y((e=>e.account)),{selected:o,count:{parallel:c}}=y((e=>e.runtime)),[u]=o,d=q.useRef(window.graph),p=e=>{d.current.setEdgeAttribute(u,"parallelIndex",e),t(E()),t(N(d.current.export()))},h=[];if(0===o.size);else if(1===o.size){if(h.push({type:"input",label:e("panel.details.info.id"),value:u,minW:276}),h.push({type:"select",label:e("panel.details.info.zIndex"),value:u?d.current.hasNode(u)?d.current.getNodeAttribute(u,"zIndex"):d.current.hasEdge(u)?d.current.getEdgeAttribute(u,"zIndex"):0:0,options:Object.fromEntries(Array.from({length:21},((e,t)=>[t-10,(t-10).toString()]))),onChange:e=>(e=>{const t=Math.min(Math.max(e,-10),10);d.current.hasNode(u)&&d.current.setNodeAttribute(u,"zIndex",t),d.current.hasEdge(u)&&d.current.setEdgeAttribute(u,"zIndex",t),a()})(Number(e))}),d.current.hasEdge(u)){const t=d.current.getEdgeAttributes(u),{parallelIndex:n,type:r}=t,i=l.RMP_CLOUD?D:T,s=c>i&&n<0||r===k.Simple,a=c>i&&n>=0;h.push({type:"switch",label:e("panel.details.info.parallel"),isDisabled:s,isChecked:n>=0,onChange:e=>((e,t)=>{let n=-1;if(e){const e=d.current.getEdgeAttributes(u),[r,i]=d.current.extremities(u);n=F(d.current,e.type,r,i,t)}p(n)})(e,t[t.type].startFrom),oneLine:!0,minW:276}),n>=0&&h.push({type:"input",label:e("panel.details.info.parallelIndex"),variant:"number",isDisabled:a,value:t.parallelIndex.toString(),onChange:e=>p(Number(e)),minW:276})}}else o.size>1&&h.push({type:"input",label:e("panel.details.info.type"),value:e("panel.details.multipleSelection.title"),minW:276});return r.jsxs(i,{p:1,children:[r.jsx(s,{as:"h5",size:"sm",children:e("panel.details.info.title")}),r.jsx(L,{fields:h,minW:130}),1===o.size&&u.startsWith("stn")&&d.current.hasNode(u)&&d.current.getNodeAttribute(u,"type")in G&&r.jsx(ne,{}),1===o.size&&u.startsWith("line")&&d.current.hasEdge(u)&&d.current.getEdgeAttribute(u,"type")in O&&d.current.getEdgeAttribute(u,"style")in C&&r.jsx(te,{}),o.size>1&&r.jsx(n,{})]})}function ie(){const{t:e}=J(),t=j(),{selected:n}=y((e=>e.runtime)),[a]=n,l=q.useRef(window.graph),[c,u]=q.useState("undefined"),[d,p]=q.useState("undefined"),[h,g]=q.useState("undefined"),[m,x]=q.useState("undefined");q.useEffect((()=>{if(null!=a&&a.startsWith("line")){const[i,s]=l.current.extremities(a);if(u(i),p(s),i.startsWith("stn")){var e,t;const n=l.current.getNodeAttribute(i,"type");g(null!==(e=null===(t=l.current.getNodeAttribute(i,n))||void 0===t?void 0:t.names.at(0))&&void 0!==e?e:"undefined")}if(s.startsWith("stn")){var n,r;const e=l.current.getNodeAttribute(s,"type");x(null!==(n=null===(r=l.current.getNodeAttribute(s,e))||void 0===r?void 0:r.names.at(0))&&void 0!==n?n:"undefined")}}}),[n]);const f=$((()=>{t(M()),t(U(c))})),b=$((()=>{t(M()),t(U(d))})),w=[{type:"custom",label:e("panel.details.lineExtremities.source"),component:r.jsx(o,{ml:"auto",size:"sm",variant:"link",onClick:f,children:c}),oneLine:!0,minW:"full"},{type:"input",label:e("panel.details.lineExtremities.sourceName"),value:h,minW:"full"},{type:"custom",label:e("panel.details.lineExtremities.target"),component:r.jsx(o,{ml:"auto",size:"sm",variant:"link",onClick:b,children:d}),oneLine:!0,minW:"full"},{type:"input",label:e("panel.details.lineExtremities.targetName"),value:m,minW:"full"}];return r.jsxs(i,{p:1,children:[r.jsx(s,{as:"h5",size:"sm",children:e("panel.details.lineExtremities.title")}),r.jsx(L,{fields:w,minW:130})]})}function se(){const{t:e}=J(),t=j(),n=q.useCallback((()=>{t(I()),t(E()),t(N(c.current.export()))}),[t,I,E,N]),{selected:a,refresh:{nodes:l}}=y((e=>e.runtime)),[o]=a,c=q.useRef(window.graph),[u,d]=q.useState({x:0,y:0});q.useEffect((()=>{if(null!=o&&o.startsWith("stn")||null!=o&&o.startsWith("misc_node_")){const e=c.current.getNodeAttribute(o,"x"),t=c.current.getNodeAttribute(o,"y");d({x:e,y:t})}}),[l,a]);const p=[{type:"input",label:e("panel.details.nodePosition.pos.x"),value:u.x.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{c.current.mergeNodeAttributes(o,{x:Number(e)}),n()}},{type:"input",label:e("panel.details.nodePosition.pos.y"),value:u.y.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{c.current.mergeNodeAttributes(o,{y:Number(e)}),n()}}];return r.jsxs(i,{p:1,children:[r.jsx(s,{as:"h5",size:"sm",children:e("panel.details.nodePosition.title")}),r.jsx(L,{fields:p,minW:130})]})}const ae=t(t({},G),ee),le=()=>{var e;const t=j(),{selected:n}=y((e=>e.runtime)),{t:i}=J(),[s]=n,a=window.graph.getNodeAttribute(s,"type"),l=a in ae&&ae[a].attrsComponent,o=null!==(e=window.graph.getNodeAttribute(s,a))&&void 0!==e?e:{};return l?r.jsx(l,{id:s,attrs:o,handleAttrsUpdate:(e,n)=>{const r=window.graph.getNodeAttribute(e,"type");window.graph.mergeNodeAttributes(e,{[r]:n}),t(I()),t(N(window.graph.export()))}}):r.jsx(b,{fontSize:"xs",m:"var(--chakra-space-1)",children:i("panel.details.unknown.error",{category:i("panel.details.unknown.node")})})},oe=()=>{var e,t;const n=j(),{preference:{autoParallel:i}}=y((e=>e.app)),{selected:s}=y((e=>e.runtime)),{t:a}=J(),[l]=s,{type:o,style:c,parallelIndex:u,reconcileId:d}=window.graph.getEdgeAttributes(l),p=null!==(e=window.graph.getEdgeAttribute(l,o))&&void 0!==e?e:{},h=o in O&&O[o].attrsComponent,g=null!==(t=window.graph.getEdgeAttribute(l,c))&&void 0!==t?t:{},m=c in C&&C[c].attrsComponent;return r.jsxs(r.Fragment,{children:[h?r.jsx(h,{id:l,attrs:p,recalculateParallelIndex:(e,t)=>{let n=-1;if(i){const[r,i]=window.graph.extremities(e);n=F(window.graph,o,r,i,t)}window.graph.setEdgeAttribute(e,"parallelIndex",n)},handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[o]:t}),n(E()),n(N(window.graph.export()))},parallelIndex:u}):r.jsx(b,{fontSize:"xs",m:"var(--chakra-space-1)",children:a("panel.details.unknown.error",{category:a("panel.details.unknown.linePath")})}),m?r.jsx(m,{id:l,attrs:g,handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[c]:t}),n(E()),n(N(window.graph.export()))},reconcileId:d}):r.jsx(b,{fontSize:"xs",m:"var(--chakra-space-1)",children:a("panel.details.unknown.error",{category:a("panel.details.unknown.lineStyle")})})]})};e("default",(()=>{const{t:e}=J(),t=j(),n=q.useRef(window.graph);q.useCallback((()=>{t(I()),t(E()),t(N(n.current.export()))}),[t,I,E,N]);const{activeSubscriptions:a}=y((e=>e.account)),{selected:l,mode:o,active:c,count:{masters:u}}=y((e=>e.runtime)),[d]=l;a.RMP_CLOUD;return r.jsxs(V,{isOpen:l.size>0&&!o.startsWith("line")&&!c,width:300,header:"Dummy header",alwaysOverlay:!0,children:[r.jsx(_,{onClose:()=>t(M()),children:e("panel.details.header")}),r.jsxs(B,{children:[r.jsx(re,{}),1===l.size&&n.current.hasNode(d)&&r.jsx(se,{}),1===l.size&&n.current.hasEdge(d)&&r.jsx(ie,{}),1===l.size&&r.jsxs(i,{p:1,children:[r.jsx(s,{as:"h5",size:"sm",children:e("panel.details.specificAttrsTitle")}),window.graph.hasNode(d)&&r.jsx(le,{}),window.graph.hasEdge(d)&&r.jsx(oe,{})]})]})]})}))}}}))}();
